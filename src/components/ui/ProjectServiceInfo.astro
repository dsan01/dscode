---
import { Icon } from 'astro-icon/components'
import type { ImageMetadata } from 'astro'
import { Image } from 'astro:assets'
import { getLangFromUrl, useTranslations } from '@i18n/utils'
import type { ProjectServiceProps as Props } from '@data/props'

const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/img/services/*.{jpeg,jpg,png,gif,webp,avif}'
)

const { Service } = Astro.props

const imagePath = `/src/assets/img/services/${Service.img}`
if (!images[imagePath])
  throw new Error(
    `"${imagePath}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`
  )

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)
console.log(Service.tech)
---

<div class='flex w-full flex-col gap-4 lg:flex-row'>
  <Image
    src={images[imagePath]() ?? '/img/bg/BG_T3.png'}
    alt={t(Service.title)}
    width={1000}
    height={1000}
    class='max-h-[250px] w-full rounded-lg object-cover object-center shadow lg:max-h-[300px] lg:w-1/3'
  />

  <div class='flex flex-col gap-4'>
    <div class='space-y-2'>
      <h5 class='font-title text-primary-500 text-3xl font-medium'>
        {t(Service.title)}
      </h5>
      <h6 class='font-title text-sm font-light text-neutral-500'>
        {t(Service.subtitle)}
      </h6>
    </div>
    <p class='font-body text-pretty text-neutral-800'>
      {t(Service.description)}
    </p>

    {
      Service.tech && Service.tech.length > 0 && (
        <div class='flex flex-col gap-2'>
          <h6 class='font-title text-primary-500 text-xl font-medium'>
            {t('service.tech.title')}
          </h6>
          <div class='flex flex-wrap gap-2'>
            {Service.tech.map((tech) => (
              <div
                class='aspect-square rounded-2xl bg-neutral-400 p-2'
                title={tech.title}
              >
                <Icon
                  name={tech.icon}
                  height='30px'
                  width='30px'
                />
              </div>
            ))}
          </div>
        </div>
      )
    }
  </div>
</div>
